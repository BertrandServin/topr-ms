<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Custom Plots for Viewing Genetic Association Results • topr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Create Custom Plots for Viewing Genetic Association Results">
<meta property="og:description" content="A collection of functions for visualizing,exploring and annotating genetic association results.Association results from multiple traits can be viewed simultaneously along with gene annotation, over the entire genome (Manhattan plot) or in the more detailed regional view.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">topr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/manhattan.html">Intro into manhattan</a>
    </li>
    <li>
      <a href="articles/regionplot.html">Intro into regionplot</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wuxi-nextcode/topr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="topr--an-r-package-for-viewing-and-annotating-genetic-association-data">topr : an R package for viewing and annotating genetic association data<a class="anchor" aria-label="anchor" href="#topr--an-r-package-for-viewing-and-annotating-genetic-association-data"></a>
</h1></div>
<p><img src="reference/figures/topr.gif" alt="topr GIF" width="100%"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<hr>
<p>Install from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"topr"</span><span class="op">)</span></code></pre></div>
<p>Or from github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"wuxi-nextcode/topr"</span><span class="op">)</span></code></pre></div>
<p>And then load the package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wuxi-nextcode/topr" class="external-link">topr</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="main-features-and-functionality">Main features and functionality<a class="anchor" aria-label="anchor" href="#main-features-and-functionality"></a>
</h2>
<hr>
<div class="section level3">
<h3 id="example-input-datasets">Example input datasets<a class="anchor" aria-label="anchor" href="#example-input-datasets"></a>
</h3>
<p>See the <a href="../vignettes/input_datasets.nb.html">Input datasets vignette</a> for more detailed information.</p>
<p>Input datasets must include least three columns (<code>CHROM, POS</code> and <code>P</code>), where naming of the columns is flexible (i.e the chr label can be either chr or chrom and is case insensitive).</p>
<p>topr has 3 in-built datasets (GWASes), take a look at one of them by issuing the following command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">CD_UKBB</span><span class="op">)</span></code></pre></div>
<p>The chromosome in the <code>CHROM</code> column can be represented with our without the <i>chr</i> suffix, e.g (chr1 or 1)</p>
</div>
<div class="section level3">
<h3 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<hr>
<p>topr’s two main plotting functions are <code><a href="reference/manhattan.html">manhattan()</a></code> and <code><a href="reference/regionplot.html">regionplot()</a></code></p>
<div class="section level4">
<h4 id="manhattan">Manhattan<a class="anchor" aria-label="anchor" href="#manhattan"></a>
</h4>
<hr>
<p>See the <a href="../vignettes/manhattan.nb.html">Manhattan vignette</a> for more detailed examples of how to use the manhattan plot function</p>
<p>View the whole genome association results on a Manhattan plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span><span class="op">)</span></code></pre></div>
<p>Annotate the lead/index variants (with p-values below 5e-09) with their nearest gene:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, annotate<span class="op">=</span><span class="fl">5e-09</span><span class="op">)</span></code></pre></div>
<p>Display genes of interest at the bottom of the Manhattan plot to get a visual representation of their position relative to association peaks:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, annotate<span class="op">=</span><span class="fl">5e-09</span>, highlight_genes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IL23R"</span>,<span class="st">"NOD2"</span>,<span class="st">"NOTCH4"</span>,<span class="st">"JAK"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>View one chromosome only:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, annotate<span class="op">=</span><span class="fl">5e-09</span>, chr<span class="op">=</span><span class="st">"chr1"</span><span class="op">)</span></code></pre></div>
<p>Create a Manhattan of multiple GWAS results (in a list) on the same plot</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UC_UKBB</span>, <span class="va">CD_UKBB</span><span class="op">)</span>, legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UC UKBB"</span>, <span class="st">"CD UKBB"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Use the <code>ntop</code> argument to control how many GWASes are displayed at the top and bottom of the plot:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UC_UKBB</span>, <span class="va">CD_UKBB</span>,<span class="va">CD_FINNGEN</span><span class="op">)</span>, legend_labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UC UKBB"</span>, <span class="st">"CD UKBB"</span>,<span class="st">"CD FINNGEN"</span><span class="op">)</span>, ntop<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="regionplot">Regionplot<a class="anchor" aria-label="anchor" href="#regionplot"></a>
</h4>
<hr>
<p>See the <a href="../vignettes/regionplot.nb.html">Regionplot vignette</a> for more detailed examples of how to use the regionplot function.</p>
<p>Further zoom-in on a genetic region by gene name:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/regionplot.html">regionplot</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, gene<span class="op">=</span><span class="st">"IL23R"</span><span class="op">)</span></code></pre></div>
<p>Label the top variant with it´s ID (rsid):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/regionplot.html">regionplot</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, gene<span class="op">=</span><span class="st">"IL23R"</span>, annotate<span class="op">=</span><span class="fl">5e-09</span><span class="op">)</span></code></pre></div>
<p>Denser labelling of top variants (every 100000 kb) with vlines to get a better visual of where the variants are in relation to the genes and exons shown below:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/regionplot.html">regionplot</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, gene<span class="op">=</span><span class="st">"IL23R"</span>, annotate_with_vline<span class="op">=</span><span class="fl">5e-09</span>, region_size<span class="op">=</span><span class="fl">100000</span><span class="op">)</span></code></pre></div>
<p>View the correlation pattern between the variants within the region in a locuszoom like plot. Note that the variant correlation (R2) has to be pre-calculated and included in the input dataframe.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/locuszoom.html">locuszoom</a></span><span class="op">(</span><span class="va">R2_CD_UKBB</span>, gene<span class="op">=</span><span class="st">"IL23R"</span><span class="op">)</span></code></pre></div>
<p>A region plot of multiple GWASes zoomed in on the IL23R gene</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/regionplot.html">regionplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">UC_UKBB</span>, <span class="va">CD_UKBB</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="useful-functions">Useful functions<a class="anchor" aria-label="anchor" href="#useful-functions"></a>
</h4>
<hr>
<p>Extract lead/index variants from the GWAS dataset (<code>CD_UKBB</code>):</p>
<pre class="{r}"><code><span class="fu"><a href="reference/get_best_snp_per_MB.html">get_best_snp_per_MB</a></span><span class="op">(</span><span class="va">CD_UKBB</span><span class="op">)</span></code></pre>
<p>Annotate the lead/index variants with their nearest gene:</p>
<pre class="{r}"><code><span class="fu"><a href="reference/get_best_snp_per_MB.html">get_best_snp_per_MB</a></span><span class="op">(</span><span class="va">CD_UKBB</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="reference/annotate_with_nearest_gene.html">annotate_with_nearest_gene</a></span><span class="op">(</span><span class="op">)</span></code></pre>
<p>Get genomic coordinates for a gene:</p>
<pre class="{r}"><code><span class="fu"><a href="reference/get_gene.html">get_gene</a></span><span class="op">(</span>gene_name<span class="op">=</span><span class="st">"IL23R"</span><span class="op">)</span></code></pre>
<p>Get snps within a region:</p>
<pre class="{r}"><code><span class="fu"><a href="reference/get_snps_within_region.html">get_snps_within_region</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, region <span class="op">=</span> <span class="st">"chr1:67138906-67259979"</span><span class="op">)</span></code></pre>
<p>Get the top variant on a chromsome:</p>
<pre class="{r}"><code><span class="fu"><a href="reference/get_top_snp.html">get_top_snp</a></span><span class="op">(</span><span class="va">CD_UKBB</span>, chr<span class="op">=</span><span class="st">"chr1"</span><span class="op">)</span></code></pre>
<p><br></p>
</div>
<div class="section level4">
<h4 id="get-help">Get help:<a class="anchor" aria-label="anchor" href="#get-help"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="fu"><a href="reference/manhattan.html">manhattan</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">?</span><span class="fu"><a href="reference/regionplot.html">regionplot</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">?</span><span class="fu"><a href="reference/locuszoom.html">locuszoom</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/wuxi-nextcode/topr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wuxi-nextcode/topr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>LGPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing topr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Thorhildur Juliusdottir <br><small class="roles"> Author, maintainer </small>  </li>
<li>Andri Stefansson <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Thorhildur Juliusdottir, Andri Stefansson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
